<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>修改我的资料</title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <link rel="stylesheet" href="../../../layuiadmin/layui/css/layui.css" media="all">
  <link rel="stylesheet" href="../../../layuiadmin/style/admin.css" media="all">
</head>
<body>

  <div class="layui-fluid" style="padding: 0px">
    <div class="layui-row layui-col-space15">
      <div class="layui-col-md12">
        <div class="layui-card">
          <!--<div class="layui-card-header">设置我的资料</div>-->
          <div class="layui-card-body" >
            <div class="layui-form" lay-filter="userEdit">
              <div class="layui-form-item">
                <label class="layui-form-label">账号</label>
                <div class="layui-input-inline">
                  <input type="text" name="username" id="username" lay-verify="required" readonly="true" class="layui-input">
                </div>
                <div class="layui-form-mid layui-word-aux">账号不可被修改</div>
              </div>
              <div class="layui-form-item">
                <label class="layui-form-label">昵称</label>
                <div class="layui-input-inline">
                  <input type="text" name="nickname" id="nickname" lay-verify="required" autocomplete="off" placeholder="请输入昵称" class="layui-input">
                </div>
              </div>
              <div class="layui-form-item">
                <label class="layui-form-label">性别</label>
                <div class="layui-input-block">
                  <input type="radio" name="sex"  value="男" title="男" >
                  <input type="radio" name="sex"   value="女" title="女" checked="true">
                </div>
              </div>
              <div class="layui-form-item">
                <label class="layui-form-label">年龄</label>
                <div class="layui-input-inline">
                  <input name="age" lay-verify="required|number|age" id="age" class="layui-input">
                </div>
              </div>

              <div class="layui-form-item" style="width: 400px">
                <label class="layui-form-label">兴趣一</label>
                <div class="layui-input-block">
                  <select name="favoriteCat1" lay-verify="required">
                    <option value=""></option>
                    <option value="互联网">互联网</option>
                    <option value="交通服务">交通服务</option>
                    <option value="人文艺术">人文艺术</option>
                    <option value="健康养生">健康养生</option>
                    <option value="健康医疗">健康医疗</option>
                    <option value="军事">军事</option>
                    <option value="动漫">动漫</option>
                    <option value="动物宠物">动物宠物</option>
                    <option value="美妆">美妆</option>
                    <option value="体育">体育</option>
                    <option value="奢侈品">奢侈品</option>
                    <option value="婚庆服务">婚庆服务</option>
                    <option value="媒体传播">媒体传播</option>
                    <option value="宗教">宗教</option>
                    <option value="情感两性">情感两性</option>
                    <option value="财经">财经</option>
                    <option value="搞笑幽默">搞笑幽默</option>
                    <option value="摄影拍照">摄影拍照</option>
                    <option value="政府政务">政府政务</option>
                    <option value="教育">教育</option>
                    <option value="旅游出行">旅游出行</option>
                    <option value="时尚">时尚</option>
                    <option value="星座命理">星座命理</option>
                    <option value="母婴育儿">母婴育儿</option>
                    <option value="汽车">汽车</option>
                    <option value="法律">法律</option>
                    <option value="数码">数码</option>
                    <option value="游戏">游戏</option>
                    <option value="电影">电影</option>
                    <option value="电视剧">电视剧</option>
                    <option value="科学科普">科学科普</option>
                    <option value="综艺节目">综艺节目</option>
                    <option value="美女帅哥">美女帅哥</option>
                    <option value="美食">美食</option>
                    <option value="职场">职场</option>
                    <option value="设计美学">设计美学</option>
                    <option value="读书作家">读书作家</option>
                    <option value="运动健身">运动健身</option>
                    <option value="音乐">音乐</option>
                    <option value="家政">家政</option>
                    <option value="公益">公益</option>
                    <option value="日化">日化</option>
                    <option value="娱乐明星">娱乐明星</option>
                    <option value="家装家居">家装家居</option>
                    <option value="休闲娱乐">休闲娱乐</option>
                    <option value="房地产">房地产</option>
                    <option value="时事">时事</option>
                    <option value="历史">历史</option>
                    <option value="广播电台">广播电台</option>
                    <option value="电信">电信</option>
                    <option value="收藏">收藏</option>
                    <option value="IT技术">IT技术</option>
                    <option value="其他">其他</option>
                    <option value="文化">文化</option>
                    <option value="社会">社会</option>
                    <option value="国际">国际</option>
                    <option value="娱乐">娱乐</option>
                    <option value="健康">健康</option>
                    <option value="科技">科技</option>
                    <option value="校园">校园</option>
                  </select>
                </div>
              </div>
              <div class="layui-form-item" style="width: 400px">
                <label class="layui-form-label">兴趣二</label>
                <div class="layui-input-block">
                  <select name="favoriteCat2" lay-verify="required">
                    <option value=""></option>
                    <option value="互联网">互联网</option>
                    <option value="交通服务">交通服务</option>
                    <option value="人文艺术">人文艺术</option>
                    <option value="健康养生">健康养生</option>
                    <option value="健康医疗">健康医疗</option>
                    <option value="军事">军事</option>
                    <option value="动漫">动漫</option>
                    <option value="动物宠物">动物宠物</option>
                    <option value="美妆">美妆</option>
                    <option value="体育">体育</option>
                    <option value="奢侈品">奢侈品</option>
                    <option value="婚庆服务">婚庆服务</option>
                    <option value="媒体传播">媒体传播</option>
                    <option value="宗教">宗教</option>
                    <option value="情感两性">情感两性</option>
                    <option value="财经">财经</option>
                    <option value="搞笑幽默">搞笑幽默</option>
                    <option value="摄影拍照">摄影拍照</option>
                    <option value="政府政务">政府政务</option>
                    <option value="教育">教育</option>
                    <option value="旅游出行">旅游出行</option>
                    <option value="时尚">时尚</option>
                    <option value="星座命理">星座命理</option>
                    <option value="母婴育儿">母婴育儿</option>
                    <option value="汽车">汽车</option>
                    <option value="法律">法律</option>
                    <option value="数码">数码</option>
                    <option value="游戏">游戏</option>
                    <option value="电影">电影</option>
                    <option value="电视剧">电视剧</option>
                    <option value="科学科普">科学科普</option>
                    <option value="综艺节目">综艺节目</option>
                    <option value="美女帅哥">美女帅哥</option>
                    <option value="美食">美食</option>
                    <option value="职场">职场</option>
                    <option value="设计美学">设计美学</option>
                    <option value="读书作家">读书作家</option>
                    <option value="运动健身">运动健身</option>
                    <option value="音乐">音乐</option>
                    <option value="家政">家政</option>
                    <option value="公益">公益</option>
                    <option value="日化">日化</option>
                    <option value="娱乐明星">娱乐明星</option>
                    <option value="家装家居">家装家居</option>
                    <option value="休闲娱乐">休闲娱乐</option>
                    <option value="房地产">房地产</option>
                    <option value="时事">时事</option>
                    <option value="历史">历史</option>
                    <option value="广播电台">广播电台</option>
                    <option value="电信">电信</option>
                    <option value="收藏">收藏</option>
                    <option value="IT技术">IT技术</option>
                    <option value="其他">其他</option>
                    <option value="文化">文化</option>
                    <option value="社会">社会</option>
                    <option value="国际">国际</option>
                    <option value="娱乐">娱乐</option>
                    <option value="健康">健康</option>
                    <option value="科技">科技</option>
                    <option value="校园">校园</option>
                  </select>
                </div>
              </div>
              <div class="layui-form-item" style="width: 400px">
                <label class="layui-form-label">兴趣三</label>
                <div class="layui-input-block">
                  <select name="favoriteCat3" lay-verify="required">
                    <option value=""></option>
                    <option value="互联网">互联网</option>
                    <option value="交通服务">交通服务</option>
                    <option value="人文艺术">人文艺术</option>
                    <option value="健康养生">健康养生</option>
                    <option value="健康医疗">健康医疗</option>
                    <option value="军事">军事</option>
                    <option value="动漫">动漫</option>
                    <option value="动物宠物">动物宠物</option>
                    <option value="美妆">美妆</option>
                    <option value="体育">体育</option>
                    <option value="奢侈品">奢侈品</option>
                    <option value="婚庆服务">婚庆服务</option>
                    <option value="媒体传播">媒体传播</option>
                    <option value="宗教">宗教</option>
                    <option value="情感两性">情感两性</option>
                    <option value="财经">财经</option>
                    <option value="搞笑幽默">搞笑幽默</option>
                    <option value="摄影拍照">摄影拍照</option>
                    <option value="政府政务">政府政务</option>
                    <option value="教育">教育</option>
                    <option value="旅游出行">旅游出行</option>
                    <option value="时尚">时尚</option>
                    <option value="星座命理">星座命理</option>
                    <option value="母婴育儿">母婴育儿</option>
                    <option value="汽车">汽车</option>
                    <option value="法律">法律</option>
                    <option value="数码">数码</option>
                    <option value="游戏">游戏</option>
                    <option value="电影">电影</option>
                    <option value="电视剧">电视剧</option>
                    <option value="科学科普">科学科普</option>
                    <option value="综艺节目">综艺节目</option>
                    <option value="美女帅哥">美女帅哥</option>
                    <option value="美食">美食</option>
                    <option value="职场">职场</option>
                    <option value="设计美学">设计美学</option>
                    <option value="读书作家">读书作家</option>
                    <option value="运动健身">运动健身</option>
                    <option value="音乐">音乐</option>
                    <option value="家政">家政</option>
                    <option value="公益">公益</option>
                    <option value="日化">日化</option>
                    <option value="娱乐明星">娱乐明星</option>
                    <option value="家装家居">家装家居</option>
                    <option value="休闲娱乐">休闲娱乐</option>
                    <option value="房地产">房地产</option>
                    <option value="时事">时事</option>
                    <option value="历史">历史</option>
                    <option value="广播电台">广播电台</option>
                    <option value="电信">电信</option>
                    <option value="收藏">收藏</option>
                    <option value="IT技术">IT技术</option>
                    <option value="其他">其他</option>
                    <option value="文化">文化</option>
                    <option value="社会">社会</option>
                    <option value="国际">国际</option>
                    <option value="娱乐">娱乐</option>
                    <option value="健康">健康</option>
                    <option value="科技">科技</option>
                    <option value="校园">校园</option>
                  </select>
                </div>
              </div>

              <div class="layui-form-item" style="width: 400px">
                <label class="layui-form-label">职业</label>
                <div class="layui-input-block">
                  <select name="userProfession" lay-verify="required">
                    <option value=""></option>
                    <option value="程序员">程序员</option>
                    <option value="产品经理">产品经理</option>
                    <option value="财务">财务</option>
                    <option value="学生">学生</option>
                    <option value="记者">记者</option>
                    <option value="厨师">厨师</option>
                    <option value="医生">医生</option>
                    <option value="文秘">文秘</option>
                  </select>
                </div>
              </div>

              <div class="layui-form-item" style="width: 400px">
                <label class="layui-form-label">所在城市</label>
                <div class="layui-input-block">
                  <select name="address" id="address" lay-verify="required">
                    <option value=""></option>
                    <option value="北京">北京</option>
                    <option value="石家庄">石家庄</option>
                    <option value="上海">上海</option>
                    <option value="天津">天津</option>
                    <option value="深圳">深圳</option>
                    <option value="广州">广州</option>
                    <option value="成都">成都</option>
                  </select>
                </div>
              </div>

              <div class="layui-form-item">
                <div class="layui-input-block">
                  <button class="layui-btn" lay-submit lay-filter="setUserInfo" name="setUserInfo" id="setUserInfo">确认修改</button>
                </div>
              </div>
            </div>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="../../../layuiadmin/layui/layui.js"></script>
  <script src="../../../js/jquery-3.2.1.min.js"></script>

  <script>
  layui.config({
    base: '../../../layuiadmin/' //静态资源所在路径
  }).extend({
    index: 'lib/index' //主入口模块
  }).use(['index', 'set']);
  </script>

<script>
  //输出检测
  layui.use(['form'], function() {
      var form = layui.form;
      form.verify({
          username: function (value, item) { //value：表单的值、item：表单的DOM对象
              if (!new RegExp("^[a-zA-Z0-9_\u4e00-\u9fa5\\s·]+$").test(value)) {
                  return '用户名不能有特殊字符';
              }
              if (/(^\_)|(\__)|(\_+$)/.test(value)) {
                  return '用户名首尾不能出现下划线\'_\'';
              }
              if (/^\d+\d+\d$/.test(value)) {
                  return '用户名不能全为数字';
              }
          }

          //我们既支持上述函数式的方式，也支持下述数组的形式
          //数组的两个值分别代表：[正则匹配、匹配不符时的提示文字]
          , age: function (value, item) {
              if (value < 1 || value > 90)
                  return '请输入正确的年龄'
              item
          }

      });
  })
</script>

 <script type="application/javascript">

      //对表单的操作
     layui.use(['form', 'layedit', 'laydate'], function(){
         var form = layui.form
             ,layer = layui.layer
             ,layedit = layui.layedit
             ,laydate = layui.laydate;

       if(localStorage.getItem('age') === null){
           //表单初始赋值
           form.val('userEdit', {
               "username": localStorage.getItem('username')
               ,"nickname":localStorage.getItem('nickname')
           });
       }
       else{
           form.val('userEdit', {
               "username": localStorage.getItem('username')
               ,"nickname":localStorage.getItem('nickname')
               ,"age":localStorage.getItem('age')
               ,"sex":localStorage.getItem('sex')
               ,"favoriteCat1":localStorage.getItem('favoriteCat1')
               ,"favoriteCat2":localStorage.getItem('favoriteCat2')
               ,"favoriteCat3":localStorage.getItem('favoriteCat3')
               ,"userProfession":localStorage.getItem('userProfession')
               ,"address":localStorage.getItem('address')
               ,"company":localStorage.getItem('company')
           });
       }

         //监听提交表单
         form.on('submit(setUserInfo)', function(data){


             //Ajax请求后端更新用户
             $.ajax({
                 type: "post"
                 ,url: "updateUserCart"
                 ,async: false
                 ,cache: false
                 ,data: data.field
                 ,dataType: "json"
                 ,success: function(res){
                   console.log(data.field);
                     layer.msg('更新成功', {
                         offset: '15px'
                         ,icon: 1
                         ,time: 1000

                     }, function(){
                         localStorage.setItem('age',data.field.age);
                         localStorage.setItem('sex',data.field.sex);
                         localStorage.setItem('favoriteCat1',data.field.favoriteCat1);
                         localStorage.setItem('favoriteCat2',data.field.favoriteCat2);
                         localStorage.setItem('favoriteCat3',data.field.favoriteCat3);
                         localStorage.setItem('userProfession',data.field.userProfession);
                         localStorage.setItem('address',data.field.address);
                         location.href= '/v3/index.html'; //跳转到登入页
                         //table.reload('LAY-shop-table'); //数据刷新
                         //parent.location.href= '/views/user/login.html';
                         //table.reload('LAY-shop-table');
                     });
                     layer.close(index);
                     return false
                 }
             });

             return false;
         });
     });
</script>

  <script>
      layui.config({
          base: '../../../layuiadmin/' //静态资源所在路径
      }).extend({
          index: 'lib/index' //主入口模块
      }).use(['index', 'form', 'upload'], function(){
          var $ = layui.$
              ,form = layui.form
              ,upload = layui.upload ;

          //监听提交
          form.on('submit(formDemo)', function(data){
              layer.msg(JSON.stringify(data.field));
              return false;
          });


          var filename;
          //上传头像图片
          upload.render({
              elem: '#LAY_imageUpload'  //绑定上传按钮
              /*,url: layui.setter.base + 'json/upload/demo.js'*/
              ,url: 'userImageAjax'
              ,accept: 'images'
              ,method: 'post'
              ,acceptMime: 'image/!*'
              ,before: function(obj){
                  //预读本地文件示例，不支持ie8
                  obj.preview(function(index, file, result){
                      filename=file.name;
                      // $('#demo1').attr('src', result); //图片链接（base64）
                  });
              }
              ,done: function(res){
                  if (res.code===0){
                      /* $(this.item).prev("div").children("input").val(res.data.src)  G:\tree.jpg*/
                      $(this.item).prev("div").children("input").val(res.data)
                  }
              }
          });

      })
  </script>


</body>
</html>